<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="restaurant">
    <!-- 식당 식별번호로 식당 한건 조회 - 우진 -->
    <select id="findByNo" resultType="restaurant">
        select
            *
        from
            tb_restaurant
        where
            rest_no = #{restNo}
    </select>

    <!-- 식당 여러 건 조회 - 우진 -->
    <select id="findAll" resultType="restaurant">
        select
            *
        from
            tb_restaurant
    </select>

    <!-- 식당 이름으로 식당 조회 - 우진 -->
    <select id="findByName" resultType="restaurant">
        select
            *
        from
            tb_restaurant
        where
            rest_name like '%' || #{restName} || '%'
    </select>

    <!-- 식당 카테고리로 식당 조회 - 우진 -->
    <select id="findByCategory" resultType="restaurant">
        select
            *
        from
            tb_restaurant
        where
            rest_category = #{restCategory}
    </select>

    <!-- 식당 등록 - 우진 -->
    <insert id="insertRestaurant">
        insert into
            tb_restaurant
        values(
                ('rest' || lpad(seq_tb_rest_no.nextval,3,0)),
                #{userNo},
                #{restName},
                #{restAddress},
                #{restContent},
                #{restPhone},
                #{restCategory},
                #{restOpenTime},
                #{restCloseTime},
                default,
                #{restReservTime},
                #{restTotalStar},
                default
              )
        <selectKey order="AFTER" resultType="String" keyProperty="restNo">
            select
                ('rest' || lpad(seq_tb_rest_no.currval,3,0))
            from
                dual
        </selectKey>
    </insert>

    <!-- 식당 내용을 수정 할 수 있다.(식당 이름, 주소, 내용, 번호) - 우진 -->
    <update id="updateRestaurant">
        update
            tb_restaurant
        set
            rest_name = #{restName},
            rest_address = #{restAddress},
            rest_content = #{restContent},
            rest_phone = #{restPhone}
        where
            rest_no = #{restNo}
    </update>

    <!-- 식당 삭제 - 우진 -->
    <delete id="deleteRestaurant">
        delete
        from
            tb_restaurant
        where
            rest_no = #{restNo}
    </delete>
</mapper>